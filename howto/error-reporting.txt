.. _howto-error-reporting:

電子メールによるエラー通知
==========================

:revision-up-to: 8961 (1.0)

.. TBD

When you're running a public site you should always turn off the
:setting:`DEBUG` setting. That will make your server run much faster, and will
also prevent malicious users from seeing details of your application that can be
revealed by the error pages.

However, running with :setting:`DEBUG` set to ``False`` means you'll never see
errors generated by your site -- everyone will just see your public error pages.
You need to keep track of errors that occur in deployed sites, so Django can be
configured to email you details of those errors.

.. _Server errors:

サーバのエラー
--------------

:setting:`DEBUG` を ``False`` にすると、コードが例外を送出し、その例外が捕
捉されず、結果的に 500 エラーになった場合に、 Django は :setting:`ADMINS`
設定にリストされている全てのユーザにメールを送信します。これは、管理者が何
らかのエラーにすぐに気づけるようにするためです。:setting:`ADMINS` はエラー
の説明文と、 Python トレースバックと、エラーを引き起こした HTTP リクエスト
の詳細情報を受け取ります。

この機能を無効にするには、:setting:`ADMINS` 設定から全てのユーザを削除して
ください。

.. _404 errors:

404 エラー
----------

Django は、サイトのリンクが切れている (404 "page not found") 時にメールを送
信するよう設定できます。 404 エラーメールは、以下の条件下で送信されます:

    * :setting:`DEBUG` が ``False`` に設定されている。
    
    * :setting:`SEND_BROKEN_LINK_EMAILS` が ``True`` に設定されている。
    
    * :setting:`MIDDLEWARE_CLASSES` 設定に ``CommonMiddleware`` が登録され
      ている (デフォルトの設定です)
    
これらの条件が揃っていると、コード中で 404 例外が生じ、かつリクエストにリファ
ラが設定されているときに、 Django は :setting:`MANAGERS` 設定に登録された全
てのユーザにメールを送信します (リファラ付きが条件なのは、リファラのないリ
クエストに対する404 エラーで管理者を煩わせないためです)。

:setting:`IGNORABLE_404_ENDS` や :setting:`IGNORABLE_404_STARTS` を使えば、
特定の 404 に対するレポート送信を抑制できます。例えば::

    IGNORABLE_404_ENDS = ('.php', '.cgi')
    IGNORABLE_404_STARTS = ('/phpmyadmin/',)

のようにすると、 URL が ``.php`` や ``.cgi`` で終わるような URL や
``/phpmyadmin/`` で始まる URL に対する 404 は報告 *されません* 。

この機能を無効にしたければ、 :setting:`SEND_BROKEN_LINK_EMAILS` を
``False`` に設定してください。

.. TBD

.. seealso::

    You can also set up custom error reporting by writing a custom piece of
    :ref:`exception middleware <exception-middleware>`. If you do write custom
    error handling, it's a good idea to emulate Django's built-in error handling
    and only report/log errors if :setting:`DEBUG` is ``False``.
